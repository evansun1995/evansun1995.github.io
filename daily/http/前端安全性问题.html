<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端安全性问题 | Evan&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="随手记录日常开发、学习中值得分享的内容。">
    
    <link rel="preload" href="/assets/css/0.styles.4288576a.css" as="style"><link rel="preload" href="/assets/js/app.229a78c0.js" as="script"><link rel="preload" href="/assets/js/2.53e3bff5.js" as="script"><link rel="preload" href="/assets/js/13.001a9598.js" as="script"><link rel="prefetch" href="/assets/js/10.d1909c60.js"><link rel="prefetch" href="/assets/js/11.c6d15166.js"><link rel="prefetch" href="/assets/js/12.d7234215.js"><link rel="prefetch" href="/assets/js/14.85f2ec60.js"><link rel="prefetch" href="/assets/js/15.d507fdd0.js"><link rel="prefetch" href="/assets/js/16.5993c16b.js"><link rel="prefetch" href="/assets/js/17.36e6c57e.js"><link rel="prefetch" href="/assets/js/18.01300c2d.js"><link rel="prefetch" href="/assets/js/3.8fcc65be.js"><link rel="prefetch" href="/assets/js/4.af1e5e17.js"><link rel="prefetch" href="/assets/js/5.5912e6dd.js"><link rel="prefetch" href="/assets/js/6.67c621a3.js"><link rel="prefetch" href="/assets/js/7.5871bd6e.js"><link rel="prefetch" href="/assets/js/8.65c81849.js"><link rel="prefetch" href="/assets/js/9.2b76874d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4288576a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Evan's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/note/" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="/team/" class="nav-link">
  团队
</a></div><div class="nav-item"><a href="/daily/" class="nav-link router-link-active">
  每日一卷
</a></div><div class="nav-item"><a href="https://github.com/evansun1995/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/note/" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="/team/" class="nav-link">
  团队
</a></div><div class="nav-item"><a href="/daily/" class="nav-link router-link-active">
  每日一卷
</a></div><div class="nav-item"><a href="https://github.com/evansun1995/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/daily/" aria-current="page" class="sidebar-link">简介</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>HTTP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/daily/http/http与https.html" class="sidebar-link">HTTP与HTTPS</a></li><li><a href="/daily/http/从输入url到页面加载完成发生了什么.html" class="sidebar-link">从输入url到页面加载完成发生了什么</a></li><li><a href="/daily/http/前端缓存.html" class="sidebar-link">前端缓存</a></li><li><a href="/daily/http/前端安全性问题.html" class="active sidebar-link">前端安全性问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/http/前端安全性问题.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/daily/http/前端安全性问题.html#xss-攻击" class="sidebar-link">XSS 攻击</a></li><li class="sidebar-sub-header"><a href="/daily/http/前端安全性问题.html#csrf-攻击" class="sidebar-link">CSRF 攻击</a></li><li class="sidebar-sub-header"><a href="/daily/http/前端安全性问题.html#点击劫持" class="sidebar-link">点击劫持</a></li><li class="sidebar-sub-header"><a href="/daily/http/前端安全性问题.html#其他" class="sidebar-link">其他</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JS</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>VUE</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>REACT</span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端安全性问题"><a href="#前端安全性问题" class="header-anchor">#</a> 前端安全性问题</h1> <p><strong>参考文章：</strong></p> <ul><li><a href="https://zoumiaojiang.com/article/common-web-security/#sql" target="_blank" rel="noopener noreferrer">常见 Web 安全攻防总结<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844903842635579405" target="_blank" rel="noopener noreferrer">【面试篇】寒冬求职之你必须要懂的Web安全<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844903685122703367" target="_blank" rel="noopener noreferrer">前端安全系列（一）：如何防止XSS攻击？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844903689702866952" target="_blank" rel="noopener noreferrer">前端安全系列之二：如何防止CSRF攻击？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>任何一个网站都会有被攻击的风险，作为一名前端，安全性问题是必须要知道的。
前端攻击方式有：XSS攻击、CSRF攻击 以及 点击劫持。
服务端的攻击方式有：SQL 注入、命令行注入、DDoS 攻击、流量劫持 和 服务器漏洞等。</p> <h2 id="xss-攻击"><a href="#xss-攻击" class="header-anchor">#</a> XSS 攻击</h2> <p>XSS 全称 Cross-Site Scripting，中文名 跨站脚本攻击。攻击者在目标网站上注入恶意代码，当用户访问网站时就会执行恶意代码，从而获取用户关键信息。
根据攻击的来源，XSS 攻击分为三种。</p> <h3 id="_1-反射型-xss"><a href="#_1-反射型-xss" class="header-anchor">#</a> 1. 反射型 XSS</h3> <p>攻击者构造出含有攻击脚本的 URL，一般是以参数的形式，如：</p> <div class="language-html extra-class"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>www.xxx.com?keyword=&lt;script&gt;alert(<span class="token punctuation">'</span>攻击代码<span class="token punctuation">'</span>)&lt;/script&gt;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>我是恶意链接<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>当用户打开时，网站服务端预渲染时，直接将含有脚本的内容直接插入到 html 中，浏览器渲染后会直接执行脚本中的代码。</p> <h3 id="_2-存储型-xss"><a href="#_2-存储型-xss" class="header-anchor">#</a> 2. 存储型 XSS</h3> <p>存储型XSS又被称为持久型 XSS，他通过前端将攻击代码提交后端并存储到数据库中，最典型的列子就是留言板。</p> <h3 id="_3-dom-型-xss"><a href="#_3-dom-型-xss" class="header-anchor">#</a> 3. DOM 型 XSS</h3> <p>类似反射型 XSS，DOM 型 XSS 指的是由前端解析 URL 中的字段时，将含有攻击的脚本直接插入到 DOM 中，渲染后执行产生 XSS 攻击，与上述两种相比，DOM 型完全是由前端造成的。</p> <h3 id="xss-攻击方式总结"><a href="#xss-攻击方式总结" class="header-anchor">#</a> XSS 攻击方式总结</h3> <ol><li>在 HTML 中内嵌的文本中，恶意内容以 script 标签形成注入。</li> <li>在内联的 JavaScript 中，拼接的数据突破了原本的限制（字符串，变量，方法名等）。</li> <li>在标签属性中，恶意内容包含引号，从而突破属性值的限制，注入其他属性或者标签。</li> <li>在标签的 href、src 等属性中，包含 javascript: 等可执行代码。</li> <li>在 onload、onerror、onclick 等事件中，注入不受控制代码。</li> <li>在 style 属性和标签中，包含类似 background-image:url(&quot;javascript:...&quot;); 的代码（新版本浏览器已经可以防范）。</li> <li>在 style 属性和标签中，包含类似 expression(...) 的 CSS 表达式代码（新版本浏览器已经可以防范）。</li></ol> <h3 id="xss-防御方案"><a href="#xss-防御方案" class="header-anchor">#</a> XSS 防御方案</h3> <ol><li><p>限制输入
限制用户输入的内容，适合如：邮箱、用户名、手机号 等固定格式场景。</p></li> <li><p>纯前端渲染
在不考虑 SEO 的情况下，采用纯前端渲染，避免使用<code>innerHTML</code>api，改用<code>textContent</code>、<code>innerText</code>等方法插入内容。如果是 Vue / React 技术栈，其内置的模板渲染引擎 以及  <code>v-html</code>/<code>dangerouslySetInnerHTML</code>方法，都会自动对内容中的特殊字符进行转义。但是该方法对于 href、src 等属性、onload、onclick等事件没有很好的处理方法，必须保证拼接上的字符串是100%可信的再使用。</p></li> <li><p>后端转义
如果需要用到后端渲染（SSR），需要对HTML模板各处插入节点进行充分转义，尽量选择一个成熟的转义库，如 JAVA 中，常用的转义库为<code>org.owasp.encoder</code>。
另外对于所有前端传入、数据库中的数据，后端在读写时，都应该对特殊字符进行转义。</p></li> <li><p>CSP
CSP 全称网页安全策略（Content-Security-Policy），用来限制网站各类资源的加载，可以在<code>meta</code>标签 或者 HTTP 请求头中配置。
详见：<a href="http://www.ruanyifeng.com/blog/2016/09/csp.html" target="_blank" rel="noopener noreferrer">Content Security Policy 入门教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ol> <h3 id="xss-的检测"><a href="#xss-的检测" class="header-anchor">#</a> XSS 的检测</h3> <p>自动扫描工具有，例如 <a href="https://github.com/Arachni/arachni" target="_blank" rel="noopener noreferrer">Arachni<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://github.com/mozilla/http-observatory/" target="_blank" rel="noopener noreferrer">Mozilla HTTP Observatory<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://github.com/andresriancho/w3af" target="_blank" rel="noopener noreferrer">w3af<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 等。</p> <h2 id="csrf-攻击"><a href="#csrf-攻击" class="header-anchor">#</a> CSRF 攻击</h2> <p>CSRF 全称 Cross-Site Request Forgery，中文名 跨站请求伪造攻击。<br>
个人理解是：CSRF 攻击一般只对使用 cookie 传递登录凭证的网站生效（除非网站不需要登录凭证就能调用关键接口），对于使用 token 作为验证方式的网站无效。<br>
攻击通常通过第三方网站发起，当用户在被攻击网站的 cookie 中存有登录凭证时，攻击者利用浏览器发起请求会携带 cookie 的特性，利用用户的凭证绕开服务器的验证，向被攻击网站发起接口请求进行攻击。</p> <h3 id="常见-csrf-攻击方式"><a href="#常见-csrf-攻击方式" class="header-anchor">#</a> 常见 CSRF 攻击方式</h3> <ol><li><p>GET 请求 CSRF：<br>
这类脚本攻击很简单，一般通过<code>img</code>标签发起,攻击网站构造类似：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 攻击网站 --&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://bank.example/withdraw?amount=10000&amp;for=hacker<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span> 
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>POST 请求 CSRF：<br>
这类请求一般通过<code>form</code>表单进行提交：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 攻击网站 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://bank.example/withdraw<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>POST</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>account<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xiaoming<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>amount<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10000<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>for<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hacker<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"> document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span> 
</code></pre></div></li> <li><p>链接型 CSRF：<br>
本质也是一种 GET 请求，相比上述两种，这种请求不需要三方网站发起攻击，而是利用被攻击网站的接口漏洞，构造 GET 请求参数，诱导用户点击链接发起请求。</p> <div class="language-html extra-class"><pre class="language-html"><code> <span class="token comment">&lt;!-- 任意其他网站中 --&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://bank.example/withdraw?amount=10000&amp;for=hacker<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>诱导链接<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li></ol> <h3 id="csrf-防御方案"><a href="#csrf-防御方案" class="header-anchor">#</a> CSRF 防御方案</h3> <ol><li><p>验证码：<br>
对于关键接口，使用验证码可以极大提升该接口的安全性，但是相对的也牺牲了一定用户体验，因此只适合安全性要求较高的接口。</p></li> <li><p>使用 Token：<br>
目前主流防御 CSRF 攻击的方案就是 Token，对于新项目可以直接使用 Token 替代 Cookie 传递用户凭证，对于使用 Cookie 的老项目，可以通过合适的方式生成 Token 进行校验。</p></li> <li><p>禁止跨域访问：<br>
我们知道 CSRF 攻击主要是通过第三方网发起，服务端在处理请求时，统一判断请求的来源（请求头中的 Origin 和 Referer 字段），只有相同域名的请求（或者绝对信任的），但是请求头容易被篡改，而且还需要处理搜索引擎爬虫的问题，需要深入的去学了解一下。</p></li> <li><p>Cookie 设置<code>Samesite</code><br>
Chrome 51 开始新增的 Cookie 属性，用来限制浏览器的 Cookie 携带机制，属于较新属性，有兼容问题。</p></li></ol> <h2 id="点击劫持"><a href="#点击劫持" class="header-anchor">#</a> 点击劫持</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>点击劫持主要是 在第三方网站采用 iframe 的形式，将被攻击的网站嵌入，一般会将该 iframe 设置为透明，在特殊按钮位置增加诱导点击按钮，用户以为点击的是第三方网站的内容，但是实际上已经被攻击了。</p> <h3 id="点击劫持-防御方案"><a href="#点击劫持-防御方案" class="header-anchor">#</a> 点击劫持 防御方案</h3> <ol><li><p>JS 判断：<br>
使用 JS 代码主动判断是否在 iframe 环境中，但是攻击网站只要在 iframe 中设置<code>sandbox</code>属性，即可禁止被攻击网站中的 JS 代码执行，因此作用有限。</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">if</span> <span class="token punctuation">(</span> top<span class="token punctuation">.</span>location <span class="token operator">!=</span> window<span class="token punctuation">.</span>location <span class="token punctuation">)</span><span class="token punctuation">{</span>
   top<span class="token punctuation">.</span>location <span class="token operator">=</span> window<span class="token punctuation">.</span>location
 <span class="token punctuation">}</span>
</code></pre></div></li> <li><p>X-FRAME-OPTIONS：<br>
X-FRAME-OPTIONS 是微软提出的一个 http 头，专门用来防御利用 iframe 嵌套的点击劫持攻击。并且在 IE8、Firefox3.6、Chrome4 以上的版本均能很好的支持。可以设置为以下值：</p> <ul><li>DENY：拒绝任何域加载</li> <li>SAMEORIGIN：允许同源域下加载</li> <li>ALLOW-FROM：可以定义允许 frame 加载的页面地址</li></ul></li></ol> <h2 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h2> <p>与前端有关的 攻击方式 主要是 XSS、XSRF 和 点击劫持。下面简单介绍一下其他几种攻击方式，不做深入探讨。</p> <h3 id="_1-sql-注入"><a href="#_1-sql-注入" class="header-anchor">#</a> 1. SQL 注入</h3> <p>一般常见于后端将前端传递的数据直接拼接到 SQL 查询字符串，攻击者通过填写包含类似<code>OR 1 = 1</code>这样的字符串，篡改后端 SQL 查询输入，获取任意想要的数据。一般后台通过使用数据库提供的参数化查询接口（占位符）即可避免。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Nodejs 使用 mysql 的 query 方法，问号为占位符</span>
mysql<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">SELECT * FROM user WHERE username = ? AND psw = ?</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">[</span>username<span class="token punctuation">,</span> psw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-命令行注入"><a href="#_2-命令行注入" class="header-anchor">#</a> 2. 命令行注入</h3> <p>类似于 SQL 注入，只不过攻击者的代码是作用于命令行中，常用解决方法是严格限制输入的内容，采用正则校验，并适当进行转义处理。</p> <h3 id="_3-ddos-攻击"><a href="#_3-ddos-攻击" class="header-anchor">#</a> 3. DDoS 攻击</h3> <p>该攻击方式是通过频繁发起请求，大量占用服务器资源，导致服务不可用。DDoS 攻击分为<code>网络层攻击</code>与<code>应用层攻击</code>，这里不展开描述。一般解决方案是：限制单 IP 请求频率、添加验证码、合理使用缓存、服务器配置负载均衡等方式解决。</p> <h3 id="_4-流量劫持"><a href="#_4-流量劫持" class="header-anchor">#</a> 4. 流量劫持</h3> <p>流量劫持分为 DNS 劫持 和 HTTP 劫持，当用户访问资源时，返回恶意网站的内容。一般来说 DNS 劫持没有好的解决方法，HTTP 劫持可以换用 HTTPS。</p> <h3 id="_5-服务器漏洞"><a href="#_5-服务器漏洞" class="header-anchor">#</a> 5. 服务器漏洞</h3> <p>服务器软件本身以及开发者的一些配置的疏忽，都容易造成被攻击的漏洞，比如最近一次的<code>Apache Log4j2</code>的漏洞，开发者在使用时一定要选择稳定合适的版本，发现问题及时升级修复漏洞。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/daily/http/前端缓存.html" class="prev">
        前端缓存
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.229a78c0.js" defer></script><script src="/assets/js/2.53e3bff5.js" defer></script><script src="/assets/js/13.001a9598.js" defer></script>
  </body>
</html>
